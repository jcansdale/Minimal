<div class='header'>
<div class='content'>
<div class='layout'>
<a href='/'><img class='portrait' src='/portrait.jpg' /></a>
<div class='name'><a href='/'>{{name}}</a></div>
<div class='bio'>{{{bio}}}</div>
<div id='toolbar' class='toolbar'>{{{social}}}</div>
<a id='subscribe' class='button' href='{{feed}}'>Subscribe</a>
</div>
<div><ul id='tabbar' class='tabbar'>{{{tabs}}}</ul></div>
</div>
</div>
<script type='text/javascript'>

registerLoadEventListener(navigation_load);

function registerLoadEventListener(callback)
{
    function raiseLoadEventListener() {
        if (document.addEventListener || event.type === 'load' || document.readyState === 'complete') {
            if (document.addEventListener ) {
                document.removeEventListener('DOMContentLoaded', raiseLoadEventListener, false);
                window.removeEventListener('load', raiseLoadEventListener, false);
            } else {
                document.detachEvent('onreadystatechange', raiseLoadEventListener);
                window.detachEvent('onload', raiseLoadEventListener);
            }
            callback();
        }
    }
    if (document.readyState === 'complete') {
        callback();
    }
    else if (document.addEventListener) {
        document.addEventListener('DOMContentLoaded', raiseLoadEventListener, false);
        window.addEventListener('load', raiseLoadEventListener, false);
    }
    else {
        document.attachEvent('onreadystatechange', raiseLoadEventListener);
        window.attachEvent('onload', raiseLoadEventListener);
    }
}

function navigation_load() {
    var path = location.pathname.substring(1);
    var link = document.body.querySelector('#tabbar').querySelector("a[href='/" + path + "']");
    if (link != null) {
        link.className = link.className + ' active';
    }
    if (path != null && path != "") {
        document.body.querySelector('#subscribe').style.visibility = 'hidden';
    }
}
</script>
